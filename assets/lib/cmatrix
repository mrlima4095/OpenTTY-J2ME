#!/bin/lua

local function cmatrix()
    local previous = graphics.getCurrent()
    local screen = graphics.new("screen", nil)
    local buffer = graphics.new("buffer", {})
    local back = graphics.new("command", { label = "Back", type = "back", priority = 1 })
    local handler = { [back] = function() graphics.display(previous) os.exit() end }

    graphics.append(screen, buffer)
    graphics.addCommand(screen, back)
    graphics.handler(screen, handler)
    graphics.display(screen)

    java.run(function ()
        while true do
            graphics.SetText(buffer, string.trim(graphics.GetText(buffer) .. " " .. math.random(10)))

            if #graphics.GetText(buffer) > 200 then graphics.SetText(buffer, "") end
        end
    end)

end

os.setproc("name", "cmatrix")
cmatrix()