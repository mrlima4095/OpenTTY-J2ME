<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>OpenTTY WAP</title>
    <meta name="description" content="OpenTTY Official Website — Terminal emulator for J2ME devices." />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light text-dark">

    <!-- Header -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary sticky-top">
        <div class="container">
            <a class="navbar-brand fw-bold text-uppercase" href="#">
                OpenTTY <span class="badge bg-warning rounded-circle">&nbsp;</span> <small class="fw-semibold">Mirror</small>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#primary-nav" aria-controls="primary-nav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div id="primary-nav" class="collapse navbar-collapse">
                <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link active" href="#">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="#downloads">Downloads</a></li>
                    <li class="nav-item"><a class="nav-link" href="#docs">Documentation</a></li>
                    <li class="nav-item"><a class="nav-link" href="#screens">Screenshots</a></li>
                    <li class="nav-item"><a class="nav-link" href="#news">News</a></li>
                    <li class="nav-item"><a class="nav-link" href="#mirrors">Mirrors</a></li>
                    <li class="nav-item"><a class="nav-link" href="#about">About</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container my-4">
        <div class="row g-4">
            <!-- Sidebar -->
            <aside class="col-lg-3">
                <div class="card mb-3">
                    <div class="card-body">
                        <h6 class="text-uppercase text-muted">Versions</h6>
                        <ul class="list-unstyled">
                            <li><a href="#downloads">Stable <span class="badge bg-info">v1.15</span></a></li>
                            <li><a href="#downloads">Pre-release <span class="badge bg-info">v1.16-rc1</span></a></li>
                            <li><a href="#downloads">Legacy <span class="badge bg-info">v1.11</span></a></li>
                        </ul>
                    </div>
                </div>
                <div class="card mb-3">
                    <div class="card-body">
                        <h6 class="text-uppercase text-muted">Platforms</h6>
                        <ul class="list-unstyled">
                            <li><a href="#downloads">Java ME (MIDP 2.0)</a></li>
                            <li><a href="#downloads">Android (APK)</a></li>
                        </ul>
                    </div>
                </div>
                <div class="card mb-3">
                    <div class="card-body">
                        <h6 class="text-uppercase text-muted">Help</h6>
                        <ul class="list-unstyled">
                            <li><a href="#docs">Getting started</a></li>
                            <li><a href="#docs">Commands manual</a></li>
                            <li><a href="#docs">J2ME permissions &amp; PushRegistry</a></li>
                            <li><a href="#docs">Keys &amp; shortcuts</a> — e.g. press <kbd>*</kbd></li>
                        </ul>
                    </div>
                </div>
                <div class="card">
                    <div class="card-body">
                        <h6 class="text-uppercase text-muted">Search</h6>
                        <form action="#" onsubmit="return false">
                            <input class="form-control mb-2" placeholder="Search…" />
                            <small class="text-muted">Press <kbd>Enter</kbd> to filter sections.</small>
                        </form>
                    </div>
                </div>
            </aside>

            <!-- Main -->
            <main class="col-lg-9">
                <!-- Hero -->
                <div class="card mb-4">
                    <div class="card-body">
                        <div class="alert alert-light border mb-3">
                            <b>OpenTTY</b> <span>Unix-based Terminal Emulator for J2ME Devices.</span>
                        </div>
                        <h1 class="h3">OpenTTY — lightweight terminal for feature phones and vintage devices</h1>
                        <p>This site provides <strong>verified downloads</strong>, <strong>checksums</strong>, documentation and news.</p>
                        <div class="d-flex flex-wrap gap-3 small text-muted mt-2">
                            <div>Last updated: <time id="lastUpdate">—</time></div>
                            <div>Signatures: <a href="#checksums">SHA-256</a></div>
                            <div>License: <a href="#about">MIT</a></div>
                        </div>
                    </div>
                </div>

                <!-- Downloads -->
                <div class="card mb-4" id="downloads">
                    <div class="card-body">
                        <h2 class="h5">Downloads</h2>
                        <p>Choose a version compatible with your J2ME device.</p>
                        <div class="table-responsive">
                            <table class="table table-sm table-bordered">
                                <thead class="table-light">
                                    <tr><th>Platform</th><th>File</th><th>Size</th></tr>
                                </thead>
                                <tbody id="dl-body"></tbody>
                            </table>
                        </div>
                        <p id="checksums" class="alert alert-warning small">
                            All releases at <a href="https://github.com/mrlima4095/OpenTTY-J2ME/releases">GitHub</a>. Checksums recommended.
                        </p>
                    </div>
                </div>

                <!-- Documentation -->
                <div class="card mb-4" id="docs">
                    <div class="card-body">
                        <h2 class="h5">Documentation</h2>
                        <ul>
                            <li><a href="#">Quick guide: installing on Java ME</a></li>
                            <li><a href="#">Manual: OpenTTY commands</a></li>
                            <li><a href="#">Permissions and <code>PushRegistry</code></a></li>
                            <li><a href="#">Keys &amp; shortcuts</a> — e.g. <kbd>*</kbd></li>
                        </ul>
                        <h6>Session example</h6>
                        <pre class="bg-dark text-light p-3 rounded small"><code>$ uname -a
Nokia S60 (OpenTTY 1.16) main/stable
2025-1.16-02x50 - CLDC-1.1 MIDP-2.1</code></pre>
                    </div>
                </div>

                <!-- Screenshots -->
                <div class="card mb-4" id="screens">
                    <div class="card-body">
                        <h2 class="h5">Screenshots</h2>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <img src="MIDlet.jpg"/>
                            </div>
                            <div class="col-md-6">
                                <img src="nano.jpg"/>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- News -->
                <div class="card mb-4" id="news">
                    <div class="card-body">
                        <h2 class="h5">News</h2>
                        <ul id="news-list"></ul>
                    </div>
                </div>

                <!-- Mirrors -->
                <div class="card mb-4" id="mirrors">
                    <div class="card-body">
                        <h2 class="h5">Mirrors</h2>
                        <p>Select a nearby mirror for faster downloads.</p>
                        <div class="list-group">
                            <a class="list-group-item list-group-item-action" href="http://opentty.xyz/repo/">
                                <strong>BR — Paraná</strong><br>
                                <small>http://opentty.xyz/repo/</small>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- About -->
                <div class="card mb-4" id="about">
                    <div class="card-body">
                        <h2 class="h5">About</h2>
                        <p>OpenTTY is a terminal emulator for J2ME devices (CLDC-1.0 / MIDP-2.0). It supports application creation and network access on constrained devices.</p>
                        <p>This website is under development.</p>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Footer -->
    <footer class="border-top py-3 mt-4 text-center text-muted small">
        © <span id="y"></span> OpenTTY — J2ME Today.
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
    (async function(){
        try {
            const res = await fetch('/api/versions');
            const data = await res.json();

            const dlBody = document.getElementById('dl-body');
            if(dlBody && data.downloads){
                dlBody.innerHTML = '';
                data.downloads.forEach(dl => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${dl.platform}</td>
                        <td><a href="${dl.url}" class="btn btn-sm btn-outline-primary">${dl.file}</a> ${dl.type ? `<span class="badge bg-secondary">${dl.type}</span>` : ''}</td>
                        <td>${dl.size}</td>
                    `;
                    dlBody.appendChild(tr);
                });
            }

            const newsContainer = document.querySelector('#news .card-body');
            if(newsContainer && data.news){
                newsContainer.querySelectorAll('ul').forEach(ul => ul.remove());
                const ul = document.createElement('ul');
                data.news.forEach(item => {
                    const li = document.createElement('li');
                    li.innerHTML = `<strong>[${item.date}]</strong> ${item.title}`;
                    ul.appendChild(li);
                });
                newsContainer.appendChild(ul);
            }
        } catch(e) { console.error('Erro ao carregar versões:', e); }
    })();

    document.getElementById('y').textContent = new Date().getFullYear();
    </script>
</body>
</html>
